<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c"><meta itemprop="name" content="BLE开发笔记——串口的使用">
<meta itemprop="description" content="进行软件开发，串口打印是个有效的调试方式，特别适用于没有显示设备的开发平台，所以为了方便调试必须要学会串口的配置和使用，在后期实现串口数据蓝牙转发的时候，也必须清楚串口的使用。本文就针对我自己的情况说一下串口的使用，CC2541有两个USART，使用都是类似的，根据使用管脚和串口的不同做适当的调整就好。">


<meta itemprop="datePublished" content="2015-10-30T14:00:00&#43;08:00" />
<meta itemprop="dateModified" content="2015-10-30T14:00:00&#43;08:00" />
<meta itemprop="wordCount" content="2434">



<meta itemprop="keywords" content="ble,uart," />
<meta property="og:title" content="BLE开发笔记——串口的使用" />
<meta property="og:description" content="进行软件开发，串口打印是个有效的调试方式，特别适用于没有显示设备的开发平台，所以为了方便调试必须要学会串口的配置和使用，在后期实现串口数据蓝牙转发的时候，也必须清楚串口的使用。本文就针对我自己的情况说一下串口的使用，CC2541有两个USART，使用都是类似的，根据使用管脚和串口的不同做适当的调整就好。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.smslit.top/2015/10/30/serial-BLE/" />
<meta property="article:published_time" content="2015-10-30T14:00:00+08:00" />
<meta property="article:modified_time" content="2015-10-30T14:00:00+08:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="BLE开发笔记——串口的使用"/>
<meta name="twitter:description" content="进行软件开发，串口打印是个有效的调试方式，特别适用于没有显示设备的开发平台，所以为了方便调试必须要学会串口的配置和使用，在后期实现串口数据蓝牙转发的时候，也必须清楚串口的使用。本文就针对我自己的情况说一下串口的使用，CC2541有两个USART，使用都是类似的，根据使用管脚和串口的不同做适当的调整就好。"/>
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>BLE开发笔记——串口的使用</title>
	<link rel="stylesheet" href="https://www.smslit.top/css/style.min.b43f86a9fe00dca489cb2beeefb24f0a9268621da439e98847877ddaf555264e.css" integrity="sha256-tD+Gqf4A3KSJyyvu77JPCpJoYh2kOemIR4d92vVVJk4=">
	
	<link rel="stylesheet" href="https://www.smslit.top/css/valine.css">
	<link rel="stylesheet" href="https://www.smslit.top/css/reward.css">
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://www.smslit.top">SMSLIT</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="https://www.smslit.top/post/">Posts</a>
					<a href="https://www.smslit.top/tags/">Tags</a>
					<a href="https://www.smslit.top/about/">Me</a>
					<a href="https://smslit.coding.me/LeetCodeDaily/">LeetCode</a>
				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="toc-btn" class="hdr-btn desktop-only-ib" title="目录"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3" y2="6"></line><line x1="3" y1="12" x2="3" y2="12"></line><line x1="3" y1="18" x2="3" y2="18"></line></svg></button><span class="hdr-social hide-in-mobile"><a href="http://weibo.com/u/2684217817" target="_blank" rel="noopener" title="Weibo"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg"  fill="none" fill-rule="evenodd" class="feather feather-mail">
    <g transform="translate(0.000000, 2.000000)" fill="#000000" fill-rule="nonzero" id="形状">
        <path d="M23.7,8.59152679 C23.6,8.94964029 23.25,9.20543566 22.9,9.25659472 C22.55,9.30775379 22.2,9.10311751 22,8.745004 C21.9,8.54036772 21.85,8.28457235 21.95,8.02877698 C22.45,6.44284573 22.1,4.70343724 21,3.4756195 C19.9,2.24780175 18.3,1.68505194 16.7,2.04316547 C16.45,2.09432453 16.2,2.04316547 16,1.88968825 C15.8,1.73621103 15.65,1.53157475 15.6,1.27577938 C15.5,0.764188657 15.8,0.252597914 16.3,0.150279784 C18.45,-0.310151871 20.75,0.354916067 22.35,2.14548362 C23.95,3.98721024 24.35,6.44284573 23.7,8.59152679 Z M17.35,5.06155077 C17.15,5.11270983 16.95,5.06155077 16.75,4.95923261 C16.55,4.85691446 16.45,4.65227818 16.4,4.44764189 C16.3,3.98721024 16.6,3.57793765 17,3.4756195 C18.1,3.21982412 19.2,3.62909671 19.95,4.44764189 C20.7,5.31734614 20.9,6.4940048 20.6,7.56834532 C20.55,7.77298161 20.4,7.92645882 20.2,8.02877698 C20,8.13109513 19.8,8.13109513 19.6,8.07993604 C19.2,7.92645882 18.95,7.46602717 19.1,7.0567546 C19.25,6.54516388 19.15,5.93125501 18.8,5.52198242 C18.4,5.11270983 17.85,4.95923261 17.35,5.06155077 Z M18.05,9.66586731 C19.45,10.126299 20.95,11.1494804 20.95,13.0423661 C20.95,16.1119105 16.6,20 10.1,20 C5.1,20 1.13686838e-13,17.5443645 1.13686838e-13,13.4516387 C1.13686838e-13,11.3029576 1.30000001,8.84732213 3.6,6.54516386 C6.6,3.42446043 10.15,2.04316547 11.45,3.37330137 C12.05,3.98721024 12.1,5.0103917 11.7,6.23820942 C11.5,6.8521183 12.25,6.4940048 12.25,6.4940048 C14.7,5.41966427 16.85,5.3685052 17.6,6.54516386 C18,7.15907273 17.95,8.02877698 17.6,9.00079935 C17.45,9.46123101 17.7,9.56354916 18.05,9.66586731 Z M10.1,18.5163869 C14.05,18.1071143 17.1,15.6003197 16.85,12.940048 C16.6,10.2797762 13.15,8.43804957 9.19999999,8.84732213 C5.25,9.25659472 2.19999998,11.7633893 2.44999999,14.4236611 C2.7,17.0839329 6.09999998,18.9256595 10.1,18.5163869 Z M10.5,10.8936851 C12.45,11.4052758 13.45,13.2981615 12.65,15.1398881 C11.85,17.0327738 9.49999999,18.0047962 7.54999999,17.3908873 C5.64999998,16.7769784 4.84999999,14.8329336 5.65000001,13.0935252 C6.45,11.3541167 8.60000002,10.3820943 10.5,10.8936851 Z M9.04999999,15.3445244 C9.45,14.7306155 9.24999998,13.9632294 8.59999999,13.7074341 C7.99999999,13.4516387 7.2,13.7074341 6.79999999,14.3213429 C6.39999998,14.9352518 6.6,15.6514788 7.2,15.9584333 C7.84999999,16.2653877 8.65000001,16.0095923 9.04999999,15.3445244 Z" fill="currentColor"></path>
    </g>
</svg></a><a href="https://www.zhihu.com/people/smslit/activities" target="_blank" rel="noopener" title="Zhihu"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="none" fill-rule="evenodd" class="feather feather-mail">
    <path d="M12.1197571,11.3394973 C11.2394396,11.2471275 8.50587146,11.3394973 8.50587146,11.3394973 L8.50587146,5.8004836 L12.5830381,5.8004836 C12.5830381,5.8004836 12.5367176,3.95412048 11.7490411,3.95412048 L5.12356308,3.95412048 L6.23550841,1 C6.23550841,1 4.56753979,1.09236985 3.96524661,2.15395489 C3.36295344,3.21553992 1.46333165,8.52386857 1.46333165,8.52386857 C1.46333165,8.52386857 2.11199596,8.80082682 3.17759547,8.0161496 C4.2432456,7.2314976 4.6138603,5.84665591 4.6138603,5.84665591 L6.5598026,5.75428606 L6.60612311,11.3856444 C6.60612311,11.3856444 3.22394129,11.3394973 2.52895647,11.3856444 C1.83397166,11.4317915 1.46330634,13.2781799 1.46330634,13.2781799 L6.60619904,13.2781799 C6.60619904,13.2781799 6.14281677,16.4169392 4.8455894,18.6787523 C3.50191497,20.9405149 1,22.7406553 1,22.7406553 C1,22.7406553 2.80693015,23.4791854 4.56761573,22.4636971 C6.32822537,21.4020364 7.62555398,16.8323387 7.62555398,16.8323387 L11.7491424,21.9559781 C11.7491424,21.9559781 12.1197824,19.5096018 11.7028219,18.8172188 C11.2394396,18.1248358 8.83019096,15.3553541 8.83019096,15.3553541 L7.76454082,16.2784726 L8.50584615,13.2319823 L12.9999986,13.2319823 C13.0000745,13.2320328 13.0000745,11.4318672 12.1197571,11.3394973 Z M14.0447646,4 L14,20.8940959 L15.6119399,20.8940959 L16.1940015,23 L19.014927,20.8940959 L23,20.8940959 L23,4 L14.0448624,4 L14.0447646,4 Z M21,18.2118088 L19.2203194,18.2118088 L16.9745545,20 L16.4660842,18.2118088 L16,18.2118088 L16,6 L21,6 L21,18.2118088 Z" id="形状" fill="currentColor" fill-rule="nonzero"></path>    
</svg></a><a href="mailto:5km@smslit.cn" target="_blank" rel="noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a><a href="https://github.com/smslit" target="_blank" rel="noopener" title="Github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="菜单"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://www.smslit.top/post/">Posts</a></li>
			<li><a href="https://www.smslit.top/tags/">Tags</a></li>
			<li><a href="https://www.smslit.top/about/">Me</a></li>
			<li><a href="https://smslit.coding.me/LeetCodeDaily/">LeetCode</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Oct 30, 2015</span></div>
				<h1>BLE开发笔记——串口的使用</h1>
			</header>
			<div class="content">
				<p>进行软件开发，串口打印是个有效的调试方式，特别适用于没有显示设备的开发平台，所以为了方便调试必须要学会串口的配置和使用，在后期实现串口数据蓝牙转发的时候，也必须清楚串口的使用。本文就针对我自己的情况说一下串口的使用，CC2541有两个USART，使用都是类似的，根据使用管脚和串口的不同做适当的调整就好。</p>

<h2 id="配置">配置</h2>

<p>我手头的是一个CC2541的最小系统，如下图所示，使用的串口是UART0，与IO的分配关系是：P1_5-&gt;TX，P1_4-&gt;RX。要实现串口的使用（不使用硬件流控制）需要进行IO的复用配置和针对串口的配置。</p>

<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/img/25atx.png" alt="1" /></p>

<h3 id="io配置">IO配置</h3>

<p>需要将P1_4和P1_5两个IO进行复用配置，同时将UART0配置到这两个IO的位置，关于这一项配置，首先得明确IO复用的map，如下很清晰地看到UART0映射到P1_4和P1_5，是配置UART0为位置2。还需要配置相应管脚优先使用串口，那么需要配置的寄存器分别是PERCFG、P1SEL和P2DIR，关于这三个寄存器的详细信息可以看我的另一篇文章 <a href="/2015/10/27/BaseRegiser-BLE/" target="_blank">BLE开发——CC2541寄存器整理</a>。</p>

<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/img/f045v.png" alt="2" /></p>

<p>配置代码：</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">PERCFG</span> <span class="o">|=</span> <span class="mh">0x01</span><span class="p">;</span>                          <span class="c1">// 配置UART0为位置2
</span><span class="c1"></span><span class="n">P1SEL</span> <span class="o">=</span> <span class="mh">0x3c</span><span class="p">;</span>                            <span class="c1">// P1_2,P1_3,P1_4,P1_5用作外设，串口功能
</span><span class="c1"></span><span class="n">P2DIR</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="mh">0xc0</span><span class="p">;</span>                          <span class="o">//</span> <span class="n">P1优先用作串口</span></code></pre></div>
<p>对了，这里得插一句，可能你不明白怎么看寄存器赋什么值，这里以上面的P1SEL为例讲一下:</p>

<p>我们知道此寄存器的描述：P1.7&ndash;P1.0的功能选择（0：通用I/O 1：外设功能）。我们需要的是P1_2,P1_3,P1_4,P1_5用作外设，所以这四个管脚对应的一个Byte的2、3、4、5bit位是1，其余bit位不管，设置为0为普通IO，所以值就是0011 1100那么对应十六进制数为0x3c。</p>

<h3 id="uart0配置">UART0配置</h3>

<p>IO配置好以后，需要对UART0的寄存器进行配置，首先得选择串口方式是UART异步通信方式，然后通过U0GCR.BAUD_E[4:0]和U0BAUD.BAUD[7:0]结合配置波特率，波特率的计算公式如下：</p>

<p>$$
BaudRate = \frac{(256+BAUD \_ M)\times2^{BAUD \_ E}}{2^{28}}\times f
$$</p>

<p>其中f是系统时钟，我设置的是32MHz外部晶振，对应32MHz时钟波特率设置配置表如下：</p>

<table>
<thead>
<tr>
<th align="center">波特率</th>
<th align="center">UxBAUD.BAUD_M</th>
<th align="center">UxBAUD.BAUD_E</th>
<th align="center">误差(%)</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">2400</td>
<td align="center">59</td>
<td align="center">6</td>
<td align="center">0.14</td>
</tr>

<tr>
<td align="center">4800</td>
<td align="center">59</td>
<td align="center">7</td>
<td align="center">0.14</td>
</tr>

<tr>
<td align="center">9600</td>
<td align="center">59</td>
<td align="center">8</td>
<td align="center">0.14</td>
</tr>

<tr>
<td align="center">14,400</td>
<td align="center">216</td>
<td align="center">8</td>
<td align="center">0.03</td>
</tr>

<tr>
<td align="center">19,200</td>
<td align="center">59</td>
<td align="center">9</td>
<td align="center">0.14</td>
</tr>

<tr>
<td align="center">28,800</td>
<td align="center">216</td>
<td align="center">9</td>
<td align="center">0.03</td>
</tr>

<tr>
<td align="center">38,400</td>
<td align="center">59</td>
<td align="center">10</td>
<td align="center">0.14</td>
</tr>

<tr>
<td align="center">57,600</td>
<td align="center">216</td>
<td align="center">10</td>
<td align="center">0.03</td>
</tr>

<tr>
<td align="center">76,800</td>
<td align="center">59</td>
<td align="center">11</td>
<td align="center">0.14</td>
</tr>

<tr>
<td align="center">115,200</td>
<td align="center">216</td>
<td align="center">11</td>
<td align="center">0.03</td>
</tr>

<tr>
<td align="center">230,400</td>
<td align="center">216</td>
<td align="center">12</td>
<td align="center">0.03</td>
</tr>
</tbody>
</table>

<p>其实还可以根据自己需求设置U0UCR对停止位、校验、起始位、位长进行配置，我没有配置使用了默认设置：8位数据位、没有校验、1个停止位。</p>

<p>配置代码：</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">U0CSR</span> <span class="o">|=</span> <span class="mh">0x80</span><span class="p">;</span>                           <span class="c1">// UART 方式
</span><span class="c1"></span><span class="n">U0GCR</span> <span class="o">|=</span> <span class="mi">11</span><span class="p">;</span>                             <span class="c1">// U0GCR与U0BAUD配合
</span><span class="c1"></span><span class="n">U0BAUD</span> <span class="o">|=</span> <span class="mi">216</span><span class="p">;</span>                           <span class="o">//</span> <span class="err">波特率设为</span><span class="mi">115200</span></code></pre></div>
<h3 id="接收中断配置">接收中断配置</h3>

<p>我采用接收中断的方式接收串口数据，所以还得需要配置中断，查询<a href="http://pan.baidu.com/s/1kTwBhpt" target="_blank">CC2541用户手册</a>可以发现设置IEN0即可，寄存器详细如下：</p>

<p><img src="https://pichome-1254392422.cos.ap-chengdu.myqcloud.com/img/soj5t.png" alt="4" /></p>

<p>设置第7位和低位即可，同时需要清空UART0串口接收中断标志，因为串口基本配置完毕，然后配置U0CSR允许接收，配置代码：</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="n">UTX0IF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                              <span class="c1">// 清除中断标志
</span><span class="c1"></span><span class="n">U0CSR</span> <span class="o">|=</span> <span class="mi">0</span><span class="n">X40</span><span class="p">;</span>                           <span class="c1">// 允许接收
</span><span class="c1"></span><span class="n">IEN0</span> <span class="o">|=</span> <span class="mh">0x84</span><span class="p">;</span>                            <span class="o">//</span> <span class="err">开总中断，接收中断</span></code></pre></div>
<h2 id="串口使用">串口使用</h2>

<p>这里采用中断的方式接收串口数据，所以必须写中断处理程序，接受搞定，那么发送数据怎么办呢？无论接收还是发送数据都是在操作U0DBUF，接收到数据后硬件会把数据放在U0DBUF，读取即可取出数据，当往U0DBUF写数据后，串口就会把数据发送出去，为了更方便使用串口，我编写了判断接收，读取数据，发送字符串、整数和浮点数的处理函数，下面分别来说一下。</p>

<h3 id="串口接收中断">串口接收中断</h3>

<p>以下代码实现将接收到的数据发回去，将程序烧进芯片，连接串口到PC，在PC端打开串口助手（这个网上有很多，自己下载一个即可，比如<a href="http://www.openjumper.com/openjumper-serial-assistant/" target="_blank">OpenJumper串口助手</a>）进行测试，PC端往串口发数据，则会看到CC2541将数据返回发送，PC端串口助手接收区便收到发送的数据。</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="c1">// 中断处理
</span><span class="c1"></span><span class="cp">#pragma vector = URX0_VECTOR
</span><span class="cp"></span><span class="n">__interrupt</span> <span class="kt">void</span> <span class="nf">UART0_ISR</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
    <span class="n">URX0IF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// 清中断标志
</span><span class="c1"></span>    <span class="n">ch</span> <span class="o">=</span> <span class="n">U0DBUF</span><span class="p">;</span>
    
    <span class="n">U0DBUF</span> <span class="o">=</span> <span class="n">ch</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>
<h3 id="串口函数">串口函数</h3>

<p>为了方便使用，写了一些函数，这里只说明一下接收：我是建立了一个缓存数组，长度64，还有一个标记指针，用来记录最新数据位置，每次接收到数据就往数组里塞，读取的时候取出数据，再逐个前移数据，标记指针减1。</p>

<p>具体实现，看我的代码，很好理解的。</p>

<ul>
<li><p>头文件serial.h</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#ifndef __SERIAL_H__
</span><span class="cp">#define __SERIAL_H__
</span><span class="cp"></span>
<span class="kt">void</span> <span class="nf">oscInit</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">serialInit</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">serialAvailable</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">serialRead</span><span class="p">();</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">serialWrite</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">dataSend</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">length</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">printInt</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">printFloat</span><span class="p">(</span><span class="kt">float</span> <span class="n">num</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">println</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">length</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">printIntln</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">printFloatln</span><span class="p">(</span><span class="kt">float</span> <span class="n">num</span><span class="p">);</span>

<span class="cp">#endif</span></code></pre></div></li>

<li><p>源文件serial.c</p>
<div class="highlight"><pre class="chroma"><code class="language-c" data-lang="c"><span class="cp">#include</span> <span class="cpf">&#34;serial.h&#34;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;ioCC2541.h&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">serialReData</span><span class="p">[</span><span class="mi">64</span><span class="p">];</span>
<span class="k">static</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">dataPoint</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="c1">// 启动外部32M晶振
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">oscInit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">SLEEPCMD</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="mh">0x04</span><span class="p">;</span>                       <span class="c1">// 启动所有晶振
</span><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">SLEEPSTA</span> <span class="o">&amp;</span> <span class="mh">0x40</span><span class="p">));</span>             <span class="c1">// 等待晶振稳定
</span><span class="c1"></span>
    <span class="n">CLKCONCMD</span> <span class="o">=</span> <span class="p">(</span><span class="n">CLKCONCMD</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x49</span><span class="p">;</span>   <span class="c1">// 使用16M晶振作为主时钟
</span><span class="c1"></span>    <span class="k">while</span> <span class="p">((</span><span class="n">CLKCONSTA</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x80</span><span class="p">)</span> <span class="o">!=</span> <span class="mh">0x49</span> <span class="p">);</span>   <span class="c1">// 等待主时钟切换到16M晶振
</span><span class="c1"></span>
    <span class="n">CLKCONCMD</span> <span class="o">=</span> <span class="p">(</span><span class="n">CLKCONCMD</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x80</span><span class="p">)</span> <span class="p">;</span>        <span class="c1">// 使用外部32K晶振作为休眠时钟
</span><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="n">CLKCONSTA</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">);</span>      <span class="c1">// 等待睡眠时钟切换到外部32K晶振
</span><span class="c1"></span>
    <span class="n">CLKCONCMD</span> <span class="o">=</span> <span class="p">(</span><span class="n">CLKCONCMD</span> <span class="o">&amp;</span> <span class="mh">0x80</span><span class="p">)</span> <span class="p">;</span>        <span class="c1">// 使用32M晶振作为主时钟
</span><span class="c1"></span>    <span class="k">while</span> <span class="p">(</span> <span class="p">(</span><span class="n">CLKCONSTA</span> <span class="o">&amp;</span> <span class="o">~</span><span class="mh">0x80</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span> <span class="p">);</span>     <span class="c1">// 等待主时钟切换到32M晶振
</span><span class="c1"></span>
    <span class="n">SLEEPCMD</span> <span class="o">|=</span> <span class="mh">0x04</span><span class="p">;</span>                       <span class="c1">// 关闭未使用的晶振
</span><span class="c1"></span><span class="p">}</span>

<span class="c1">// 串口初始化
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">serialInit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 初始化串口的IO
</span><span class="c1"></span>    <span class="n">PERCFG</span> <span class="o">|=</span> <span class="mh">0x01</span><span class="p">;</span>                          <span class="c1">// 配置UART0为位置2
</span><span class="c1"></span>    <span class="n">P1SEL</span> <span class="o">=</span> <span class="mh">0x3c</span><span class="p">;</span>                            <span class="c1">// P1_2,P1_3,P1_4,P1_5用作串口功能
</span><span class="c1"></span>    <span class="n">P2DIR</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="mh">0xc0</span><span class="p">;</span>                          <span class="c1">// P1优先用作串口
</span><span class="c1"></span>    <span class="c1">// 配置串口
</span><span class="c1"></span>    <span class="n">U0CSR</span> <span class="o">|=</span> <span class="mh">0x80</span><span class="p">;</span>                           <span class="c1">// UART 方式
</span><span class="c1"></span>    <span class="n">U0GCR</span> <span class="o">|=</span> <span class="mi">11</span><span class="p">;</span>                             <span class="c1">// U0GCR与U0BAUD配合
</span><span class="c1"></span>    <span class="n">U0BAUD</span> <span class="o">|=</span> <span class="mi">216</span><span class="p">;</span>                           <span class="c1">// 波特率设为115200
</span><span class="c1"></span>    <span class="n">UTX0IF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>                              <span class="c1">// 清除中断标志
</span><span class="c1"></span>    <span class="n">U0CSR</span> <span class="o">|=</span> <span class="mi">0</span><span class="n">X40</span><span class="p">;</span>                           <span class="c1">// 允许接收
</span><span class="c1"></span>    <span class="n">IEN0</span> <span class="o">|=</span> <span class="mh">0x84</span><span class="p">;</span>                            <span class="c1">// 开总中断，接收中断
</span><span class="c1"></span><span class="p">}</span>

<span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">serialAvailable</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">dataPoint</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 读取一个Byte
</span><span class="c1"></span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">serialRead</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">serialReData</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="k">if</span><span class="p">(</span><span class="n">dataPoint</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">dataPoint</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">serialReData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">serialReData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">dataPoint</span><span class="o">--</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">dataPoint</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ch</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 发送一个Byte数据
</span><span class="c1"></span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="nf">serialWrite</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">dataSend</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">U0DBUF</span> <span class="o">=</span> <span class="n">dataSend</span><span class="p">;</span>
    <span class="k">while</span><span class="p">((</span><span class="n">U0CSR</span> <span class="o">&amp;</span> <span class="mh">0x01</span><span class="p">)</span> <span class="o">==</span> <span class="mh">0x01</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// 按个数发送字符串
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">print</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">serialWrite</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">bytes</span><span class="o">+</span><span class="n">i</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// 发送整数
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">printInt</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">serialWrite</span><span class="p">(</span><span class="mh">0x30</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
        <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">nT</span><span class="p">;</span>
        <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">num</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">serialWrite</span><span class="p">(</span><span class="sc">&#39;-&#39;</span><span class="p">);</span>
            <span class="n">nT</span><span class="o">=-</span><span class="n">num</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">nT</span> <span class="o">=</span> <span class="n">num</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">ch</span> <span class="o">=</span> <span class="n">nT</span><span class="o">/</span><span class="mi">10000</span><span class="o">+</span><span class="mh">0x30</span><span class="p">;</span>
            <span class="n">nT</span> <span class="o">%=</span> <span class="mi">10000</span><span class="p">;</span>
            <span class="n">nT</span> <span class="o">*=</span> <span class="mi">10</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">serialWrite</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span><span class="n">ch</span> <span class="o">&gt;</span> <span class="mh">0x30</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="n">serialWrite</span><span class="p">(</span><span class="n">ch</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 发送两位小数
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">printFloat</span><span class="p">(</span><span class="kt">float</span> <span class="n">numFloat</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">numI</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">numFloat</span><span class="p">;</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">factor</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
    <span class="n">printInt</span><span class="p">(</span><span class="n">numI</span><span class="p">);</span>
    <span class="n">numI</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="n">numFloat</span><span class="o">*</span><span class="n">factor</span><span class="o">-</span><span class="n">numI</span><span class="o">*</span><span class="n">factor</span><span class="p">);</span>
    <span class="n">serialWrite</span><span class="p">(</span><span class="sc">&#39;.&#39;</span><span class="p">);</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">numI</span> <span class="o">/</span> <span class="mi">10</span><span class="p">;</span>
    <span class="n">serialWrite</span><span class="p">(</span><span class="n">ch</span><span class="o">+</span><span class="mh">0x30</span><span class="p">);</span>
    <span class="n">ch</span> <span class="o">=</span> <span class="n">numI</span> <span class="o">%</span> <span class="mi">10</span><span class="p">;</span>
    <span class="n">serialWrite</span><span class="p">(</span><span class="n">ch</span><span class="o">+</span><span class="mh">0x30</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 发送字符串（带换行）
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">println</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">bytes</span><span class="p">,</span> <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">print</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
    <span class="n">serialWrite</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// 发送整数（带换行）
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">printIntln</span><span class="p">(</span><span class="kt">int</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printInt</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
    <span class="n">serialWrite</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">// 发送两位小数（带换行）
</span><span class="c1"></span><span class="kt">void</span> <span class="nf">printFloatln</span><span class="p">(</span><span class="kt">float</span> <span class="n">num</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">printFloat</span><span class="p">(</span><span class="n">num</span><span class="p">);</span>
    <span class="n">serialWrite</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// 中断处理
</span><span class="c1"></span><span class="cp">#pragma vector = URX0_VECTOR
</span><span class="cp"></span><span class="n">__interrupt</span> <span class="kt">void</span> <span class="nf">UART0_ISR</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">ch</span><span class="p">;</span>
    <span class="n">URX0IF</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>    <span class="c1">// 清中断标志
</span><span class="c1"></span>    <span class="n">ch</span> <span class="o">=</span> <span class="n">U0DBUF</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">dataPoint</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">serialReData</span><span class="p">[</span><span class="n">dataPoint</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">;</span>
        <span class="n">dataPoint</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">63</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">serialReData</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">serialReData</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="n">dataPoint</span> <span class="o">=</span> <span class="mi">63</span><span class="p">;</span>
        <span class="n">serialReData</span><span class="p">[</span><span class="mi">63</span><span class="p">]</span> <span class="o">=</span> <span class="n">ch</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">U0DBUF</span> <span class="o">=</span> <span class="n">ch</span><span class="p">;</span>
<span class="p">}</span></code></pre></div></li>
</ul>
			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://www.smslit.top/tags/ble">ble</a></span><span class="tag"><a href="https://www.smslit.top/tags/uart">uart</a></span>
				</p>
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
					2434 字
				</p>
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
					2015-10-30 14:00 &#43;0800</p>
			</footer>
		</article>
		<aside id="toc">
			<div class="toc-title">目录</div>
			<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#配置">配置</a>
<ul>
<li><a href="#io配置">IO配置</a></li>
<li><a href="#uart0配置">UART0配置</a></li>
<li><a href="#接收中断配置">接收中断配置</a></li>
</ul></li>
<li><a href="#串口使用">串口使用</a>
<ul>
<li><a href="#串口接收中断">串口接收中断</a></li>
<li><a href="#串口函数">串口函数</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
		</aside>
		<div class="post-nav thin">
			<a class="next-post" href="https://www.smslit.top/2015/10/30/temperature-BLE/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;下一篇</span><br><span>BLE开发笔记——读取片上温度传感器数据</span>
			</a>
			<a class="prev-post" href="https://www.smslit.top/2015/10/30/clockOSC-BLE/">
				<span class="post-nav-label">上一篇&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>BLE开发笔记——时钟和晶振</span>
			</a>
		</div>
		<div id="comments" class="thin">
		<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">打赏作者</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/assets/pay/wechatpay.png">
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/assets/pay/alipay.png">
      </label>
  </div>
</div>


<span id="/2015/10/30/serial-BLE/" class="leancloud_visitors" data-flag-title="BLE开发笔记——串口的使用">
  <span class="post-meta-item-text">访问量 </span>
  <span class="leancloud-visitors-count"></span>
  <p></p>
</span>
<div id="vcomments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script type="text/javascript">
  new Valine({
      el: '#vcomments' ,
      appId: 'IlJ4XQsE83q10RN3Maoglx2x-gzGzoHsz',
      appKey: 'OxVuAMUYBTbDMO9vO2IqTsMR',
      notify:  false , 
      verify:  false , 
      avatar:'', 
      placeholder: '说点什么吧...(提醒：填写邮箱，若有人回复您，您将及时收到提醒邮件！)',
      visitor:  true 
  });
</script>
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2019 <a href="https://www.smslit.top">5km</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://www.smslit.top/post/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="https://www.smslit.top/js/main.min.8f39f24808e9d0a9b02da58c2d2838da859dc0b7bdfadbdb1883aae8b6adacfe.js" integrity="sha256-jznySAjp0KmwLaWMLSg42oWdwLe9+tvbGIOq6LatrP4="></script>

	
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: {equationNumbers: {autoNumber: "AMS"}},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>

</html>
