<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#494f5c">
	<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="argparse 库的使用">
<meta itemprop="description" content="如果您接触过命令行的话，一定感受过命令工具的使用，会有个参数的概念，比如以列表的形式列出当前目录下的所有可见文件：ls -l。进行python开发的时候，也许最终会以命令行工具的形式工作，可能需要对命令参数进行处理，那么可以使用 sys.argv 获取命令输入的参数列表，进行分析判断做相应处理，但随着参数项增多，这种方式会越来越复杂，而本文将要介绍的 argparse 库，会使参数的管理变得优雅，下面一起看一下怎么使用吧！">


<meta itemprop="datePublished" content="2018-09-13T15:16:37&#43;08:00" />
<meta itemprop="dateModified" content="2018-09-13T15:16:37&#43;08:00" />
<meta itemprop="wordCount" content="5014">



<meta itemprop="keywords" content="develop,python," />
<meta property="og:title" content="argparse 库的使用" />
<meta property="og:description" content="如果您接触过命令行的话，一定感受过命令工具的使用，会有个参数的概念，比如以列表的形式列出当前目录下的所有可见文件：ls -l。进行python开发的时候，也许最终会以命令行工具的形式工作，可能需要对命令参数进行处理，那么可以使用 sys.argv 获取命令输入的参数列表，进行分析判断做相应处理，但随着参数项增多，这种方式会越来越复杂，而本文将要介绍的 argparse 库，会使参数的管理变得优雅，下面一起看一下怎么使用吧！" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.smslit.top/2018/09/13/python-argparse/" />
<meta property="article:published_time" content="2018-09-13T15:16:37&#43;08:00"/>
<meta property="article:modified_time" content="2018-09-13T15:16:37&#43;08:00"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="argparse 库的使用"/>
<meta name="twitter:description" content="如果您接触过命令行的话，一定感受过命令工具的使用，会有个参数的概念，比如以列表的形式列出当前目录下的所有可见文件：ls -l。进行python开发的时候，也许最终会以命令行工具的形式工作，可能需要对命令参数进行处理，那么可以使用 sys.argv 获取命令输入的参数列表，进行分析判断做相应处理，但随着参数项增多，这种方式会越来越复杂，而本文将要介绍的 argparse 库，会使参数的管理变得优雅，下面一起看一下怎么使用吧！"/>
	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>argparse 库的使用</title>
	<link rel="stylesheet" href="https://www.smslit.top/css/style.min.645b14dc26ce57a45585b37a4ef11a96fee72376dcd62ffbcd5103cd5edf7f1c.css" integrity="sha256-ZFsU3CbOV6RVhbN6TvEalv7nI3bc1i/7zVEDzV7ffxw=">
	
	<link rel="stylesheet" href="https://www.smslit.top/css/valine.css">
	<link rel="stylesheet" href="https://www.smslit.top/css/reward.css">
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://www.smslit.top">SMSLIT</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					<a href="https://www.smslit.top/post/">Posts</a>
					<a href="https://www.smslit.top/tags/">Tags</a>
					<a href="https://www.smslit.top/about/">Me</a>
					<a href="https://smslit.coding.me/ownwiki/">wiki</a>
				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="toc-btn" class="hdr-btn desktop-only-ib" title="目录"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3" y2="6"></line><line x1="3" y1="12" x2="3" y2="12"></line><line x1="3" y1="18" x2="3" y2="18"></line></svg></button><span class="hdr-social hide-in-mobile"><a href="http://weibo.com/u/2684217817" target="_blank" rel="noopener" title="Weibo"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg"  fill="none" fill-rule="evenodd" class="feather feather-mail">
    <g transform="translate(0.000000, 2.000000)" fill="#000000" fill-rule="nonzero" id="形状">
        <path d="M23.7,8.59152679 C23.6,8.94964029 23.25,9.20543566 22.9,9.25659472 C22.55,9.30775379 22.2,9.10311751 22,8.745004 C21.9,8.54036772 21.85,8.28457235 21.95,8.02877698 C22.45,6.44284573 22.1,4.70343724 21,3.4756195 C19.9,2.24780175 18.3,1.68505194 16.7,2.04316547 C16.45,2.09432453 16.2,2.04316547 16,1.88968825 C15.8,1.73621103 15.65,1.53157475 15.6,1.27577938 C15.5,0.764188657 15.8,0.252597914 16.3,0.150279784 C18.45,-0.310151871 20.75,0.354916067 22.35,2.14548362 C23.95,3.98721024 24.35,6.44284573 23.7,8.59152679 Z M17.35,5.06155077 C17.15,5.11270983 16.95,5.06155077 16.75,4.95923261 C16.55,4.85691446 16.45,4.65227818 16.4,4.44764189 C16.3,3.98721024 16.6,3.57793765 17,3.4756195 C18.1,3.21982412 19.2,3.62909671 19.95,4.44764189 C20.7,5.31734614 20.9,6.4940048 20.6,7.56834532 C20.55,7.77298161 20.4,7.92645882 20.2,8.02877698 C20,8.13109513 19.8,8.13109513 19.6,8.07993604 C19.2,7.92645882 18.95,7.46602717 19.1,7.0567546 C19.25,6.54516388 19.15,5.93125501 18.8,5.52198242 C18.4,5.11270983 17.85,4.95923261 17.35,5.06155077 Z M18.05,9.66586731 C19.45,10.126299 20.95,11.1494804 20.95,13.0423661 C20.95,16.1119105 16.6,20 10.1,20 C5.1,20 1.13686838e-13,17.5443645 1.13686838e-13,13.4516387 C1.13686838e-13,11.3029576 1.30000001,8.84732213 3.6,6.54516386 C6.6,3.42446043 10.15,2.04316547 11.45,3.37330137 C12.05,3.98721024 12.1,5.0103917 11.7,6.23820942 C11.5,6.8521183 12.25,6.4940048 12.25,6.4940048 C14.7,5.41966427 16.85,5.3685052 17.6,6.54516386 C18,7.15907273 17.95,8.02877698 17.6,9.00079935 C17.45,9.46123101 17.7,9.56354916 18.05,9.66586731 Z M10.1,18.5163869 C14.05,18.1071143 17.1,15.6003197 16.85,12.940048 C16.6,10.2797762 13.15,8.43804957 9.19999999,8.84732213 C5.25,9.25659472 2.19999998,11.7633893 2.44999999,14.4236611 C2.7,17.0839329 6.09999998,18.9256595 10.1,18.5163869 Z M10.5,10.8936851 C12.45,11.4052758 13.45,13.2981615 12.65,15.1398881 C11.85,17.0327738 9.49999999,18.0047962 7.54999999,17.3908873 C5.64999998,16.7769784 4.84999999,14.8329336 5.65000001,13.0935252 C6.45,11.3541167 8.60000002,10.3820943 10.5,10.8936851 Z M9.04999999,15.3445244 C9.45,14.7306155 9.24999998,13.9632294 8.59999999,13.7074341 C7.99999999,13.4516387 7.2,13.7074341 6.79999999,14.3213429 C6.39999998,14.9352518 6.6,15.6514788 7.2,15.9584333 C7.84999999,16.2653877 8.65000001,16.0095923 9.04999999,15.3445244 Z" fill="currentColor"></path>
    </g>
</svg></a><a href="https://www.zhihu.com/people/smslit/activities" target="_blank" rel="noopener" title="Zhihu"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="none" fill-rule="evenodd" class="feather feather-mail">
    <path d="M12.1197571,11.3394973 C11.2394396,11.2471275 8.50587146,11.3394973 8.50587146,11.3394973 L8.50587146,5.8004836 L12.5830381,5.8004836 C12.5830381,5.8004836 12.5367176,3.95412048 11.7490411,3.95412048 L5.12356308,3.95412048 L6.23550841,1 C6.23550841,1 4.56753979,1.09236985 3.96524661,2.15395489 C3.36295344,3.21553992 1.46333165,8.52386857 1.46333165,8.52386857 C1.46333165,8.52386857 2.11199596,8.80082682 3.17759547,8.0161496 C4.2432456,7.2314976 4.6138603,5.84665591 4.6138603,5.84665591 L6.5598026,5.75428606 L6.60612311,11.3856444 C6.60612311,11.3856444 3.22394129,11.3394973 2.52895647,11.3856444 C1.83397166,11.4317915 1.46330634,13.2781799 1.46330634,13.2781799 L6.60619904,13.2781799 C6.60619904,13.2781799 6.14281677,16.4169392 4.8455894,18.6787523 C3.50191497,20.9405149 1,22.7406553 1,22.7406553 C1,22.7406553 2.80693015,23.4791854 4.56761573,22.4636971 C6.32822537,21.4020364 7.62555398,16.8323387 7.62555398,16.8323387 L11.7491424,21.9559781 C11.7491424,21.9559781 12.1197824,19.5096018 11.7028219,18.8172188 C11.2394396,18.1248358 8.83019096,15.3553541 8.83019096,15.3553541 L7.76454082,16.2784726 L8.50584615,13.2319823 L12.9999986,13.2319823 C13.0000745,13.2320328 13.0000745,11.4318672 12.1197571,11.3394973 Z M14.0447646,4 L14,20.8940959 L15.6119399,20.8940959 L16.1940015,23 L19.014927,20.8940959 L23,20.8940959 L23,4 L14.0448624,4 L14.0447646,4 Z M21,18.2118088 L19.2203194,18.2118088 L16.9745545,20 L16.4660842,18.2118088 L16,18.2118088 L16,6 L21,6 L21,18.2118088 Z" id="形状" fill="currentColor" fill-rule="nonzero"></path>    
</svg></a><a href="mailto:5km@smslit.cn" target="_blank" rel="noopener" title="Email"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a><a href="https://github.com/smslit" target="_blank" rel="noopener" title="Github"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a></span><button id="menu-btn" class="hdr-btn" title="菜单"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://www.smslit.top/post/">Posts</a></li>
			<li><a href="https://www.smslit.top/tags/">Tags</a></li>
			<li><a href="https://www.smslit.top/about/">Me</a></li>
			<li><a href="https://smslit.coding.me/ownwiki/">wiki</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Sep 13, 2018</span></div>
				<h1>argparse 库的使用</h1>
			</header>
			<div class="content">
				<p>如果您接触过命令行的话，一定感受过命令工具的使用，会有个参数的概念，比如以列表的形式列出当前目录下的所有可见文件：<code>ls -l</code>。进行python开发的时候，也许最终会以命令行工具的形式工作，可能需要对命令参数进行处理，那么可以使用 <code>sys.argv</code> 获取命令输入的参数列表，进行分析判断做相应处理，但随着参数项增多，这种方式会越来越复杂，而本文将要介绍的 <strong>argparse</strong> 库，会使参数的管理变得优雅，下面一起看一下怎么使用吧！</p>

<p>本文就不用解释这个参数的概念了吧，相信您对参数这个概念有了自己的感受，开发一个属于自己的命令工具一定很酷，Let&rsquo;s do it!</p>

<h2 id="初步感受">初步感受</h2>

<p>本文以python3开发为例，以一个简单的示例开始，创建文件 <strong>pug.py</strong> ，代码：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span></code></pre></div>
<p>我们运行初步感受一下：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py
$ python3 pug.py --help
usage: pug.py <span class="o">[</span>-h<span class="o">]</span>

optional arguments:
  -h, --help  show this <span class="nb">help</span> message and <span class="nb">exit</span>
$ python3 pug.py --verbose
usage: pug.py <span class="o">[</span>-h<span class="o">]</span>
pug.py: error: unrecognized arguments: --verbose
$ python3 pug.py foo
usage: pug.py <span class="o">[</span>-h<span class="o">]</span>
pug.py: error: unrecognized arguments: foo</code></pre></div>
<p>看看发生了什么：</p>

<ul>
<li>直接运行文件，不加任何参数，没有任何处理；</li>
<li>第二次执行加了参数 <strong>&ndash;help</strong> 会打印一定的帮助信息，这个帮助信息中可以看到 <strong>&ndash;help</strong>可以简写为 <strong>-h</strong>；</li>
<li>第三次和第四次执行使用了不支持的参数，打印了错误提醒；</li>
</ul>

<p><strong>parser.parse_args()</strong> 就是参数解析的过程。</p>

<h2 id="positional-arguments-的使用">Positional arguments 的使用</h2>

<p><strong>Positional arguments</strong> 怎么翻译比较好呢？看到网上有人叫它 <strong>定位参数</strong>，我咋觉得叫它 <strong>占位参数</strong> 会比较贴切呢，无所谓了，还是用它本名 <strong>Positional arguments</strong> 吧！</p>

<p>更改pug.py代码为：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;echo&#34;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">echo</span><span class="p">)</span></code></pre></div>
<p>执行看看：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="nb">echo</span>
pug.py: error: the following arguments are required: <span class="nb">echo</span>
$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="nb">echo</span>

positional arguments:
  <span class="nb">echo</span>

optional arguments:
  -h, --help  show this <span class="nb">help</span> message and <span class="nb">exit</span>
$ python3 pug.py yeah
yeah</code></pre></div>
<p>可以看到在方法 <strong>add_argument</strong> 的帮助下 <strong>echo</strong> 成功上位，使用命令时必须为echo位置上输上点什么，它才罢休，这里可以简单地认为echo是一个必须赋值的变量。似乎少了点这个参数的帮助信息，不要紧！有方法 <strong>add_argument</strong> 的加持啥都不怕，此方法有个参数 <strong>help</strong>，为其指定内容就可以填充帮助信息了，比如这样：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;echo&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;学您说话！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">echo</span><span class="p">)</span></code></pre></div>
<p>运行看看：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="nb">echo</span>

positional arguments:
  <span class="nb">echo</span>        学您说话！

optional arguments:
  -h, --help  show this <span class="nb">help</span> message and exit</code></pre></div>
<p>下面，我们不能让pug太调皮，得干点实用的事，比如让它算数，那就让它算一个指定整数的平方吧，修改代码如下：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">square</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></code></pre></div>
<p>执行一下：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py <span class="m">2</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&#34;pug.py&#34;</span>, line <span class="m">5</span>, in &lt;module&gt;
    print<span class="o">(</span>args.square**2<span class="o">)</span>
TypeError: unsupported operand type<span class="o">(</span>s<span class="o">)</span> <span class="k">for</span> ** or pow<span class="o">()</span>: <span class="s1">&#39;str&#39;</span> and <span class="s1">&#39;int&#39;</span></code></pre></div>
<p>出错啦！为什么？因为参数默认都是字符串，小狗子pug肯定不会计算字符串的平方吧！<strong>add_argument</strong> 方法此时笑了，不用担心，它可以为您按类型解析这个参数的值，只需指定方法的参数 <strong>type</strong> 就可以了：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">square</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span></code></pre></div>
<p>试一下效果：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py <span class="m">2</span>
<span class="m">4</span>
$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> square

positional arguments:
  square      您说个数，我就能告诉您这个数的平方！

optional arguments:
  -h, --help  show this <span class="nb">help</span> message and exit</code></pre></div>
<p>小狗子pug可以的！</p>

<h2 id="optional-arguments-的使用">Optional arguments 的使用</h2>

<p>下面一起看一下可选参数（<strong>Optional arguments</strong>）的使用。</p>

<p>代码更改为：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;我睡着了(-_-)zzz，别打搅我！&#39;</span><span class="p">)</span></code></pre></div>
<p>看一下小狗子有多懒：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>--sleep SLEEP<span class="o">]</span>

optional arguments:
  -h, --help     show this <span class="nb">help</span> message and <span class="nb">exit</span>
  --sleep SLEEP  让我睡会儿，困死了！
$ python3 pug.py --sleep <span class="m">1</span>
我睡着了<span class="o">(</span>-_-<span class="o">)</span>zzz，别打搅我！</code></pre></div>
<p>简单来说，对于睡觉，要么睡着要么没睡，应该是二值，那可以限制这个参数 <strong>&ndash;sleep</strong> 要么 <strong>True</strong> 要么 <strong>False</strong>，方法 <strong>add_argument</strong> 提供了设置参数 <strong>action</strong> ，设置其为 <strong>store_true</strong> 即可：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;我睡着了(-_-)zzz，别打搅我！&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;我很清醒，不想睡觉！&#39;</span><span class="p">)</span></code></pre></div>
<p>逗一下小狗子pug：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>--sleep<span class="o">]</span>

optional arguments:
  -h, --help  show this <span class="nb">help</span> message and <span class="nb">exit</span>
  --sleep     让我睡会儿，困死了！
$ python3 pug.py --sleep <span class="m">1</span>
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>--sleep<span class="o">]</span>
pug.py: error: unrecognized arguments: <span class="m">1</span>
$ python3 pug.py --sleep
我睡着了<span class="o">(</span>-_-<span class="o">)</span>zzz，别打搅我！
$ python3 pug.py
我很清醒，不想睡觉！</code></pre></div>
<p>可以看到，运行命令时，如果指定参数 <strong>&ndash;sleep</strong>，那么这个参数值就为 <strong>True</strong>， 如果没有，那么参数值为 <strong>False</strong>。如果您了解命令行工具的使用一定会问：短参数的实现会是怎样的？其实很简单：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;我睡着了(-_-)zzz，别打搅我！&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;我很清醒，不想睡觉！&#39;</span><span class="p">)</span></code></pre></div>
<p>叫小狗子pug试一下：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s<span class="o">]</span>

optional arguments:
  -h, --help   show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -s, --sleep  让我睡会儿，困死了！
$ python3 pug.py -s
我睡着了<span class="o">(</span>-_-<span class="o">)</span>zzz，别打搅我！</code></pre></div>
<h2 id="positional-arguments-和-optional-arguments-结合使用">Positional arguments 和 Optional arguments 结合使用</h2>

<p>让小狗子睡着觉算数会是咋样的，试一下：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;我睡着了(-_-)zzz都能算数：{answer}！&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;我很清醒，结果是：{answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>让小狗子嚣张嚣张：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py -s <span class="m">3</span>
我睡着了<span class="o">(</span>-_-<span class="o">)</span>zzz都能算数：9！
$ python3 pug.py <span class="m">3</span>
我很清醒，结果是：9!
$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s<span class="o">]</span> square

positional arguments:
  square       您说个数，我就能告诉您这个数的平方！

optional arguments:
  -h, --help   show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -s, --sleep  让我睡会儿，困死了！</code></pre></div>
<p>小狗子很厉害呀，睡着觉都给算出结果来了，那小狗子睡觉也分状态的吧，熟睡和半睡半醒状态应该会不一样，看一下会怎么样：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：{answer}！&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;半睡半醒的我当然听得清你说什么，很简单的题嘛：{answer}!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;我很清醒，结果是：{answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>那我们考一下小狗子：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py <span class="m">3</span> -s
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s SLEEP<span class="o">]</span> square
pug.py: error: argument -s/--sleep: expected one argument
$ python3 pug.py <span class="m">3</span> -s <span class="m">1</span>
半睡半醒的我当然听得清你说什么，很简单的题嘛：9!
$ python3 pug.py <span class="m">3</span> -s <span class="m">2</span>
虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：9！
$ python3 pug.py <span class="m">3</span> -s <span class="m">0</span>
我很清醒，结果是：9!
$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s SLEEP<span class="o">]</span> square

positional arguments:
  square                您说个数，我就能告诉您这个数的平方！

optional arguments:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -s SLEEP, --sleep SLEEP
                        让我睡会儿，困死了！
$ python3 pug.py <span class="m">3</span>
我很清醒，结果是：9!</code></pre></div>
<p>简直了，但是这里有个问题，pug睡觉状态并不是很多，如果我们指定其它可能没有必要嘛，能不能对值进行限制呢？当然可以啦，添加参数时给定 <strong>choices</strong> 就可以啦：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：{answer}！&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;半睡半醒的我当然听得清你说什么，很简单的题嘛：{answer}!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;我很清醒，结果是：{answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>看一下效果：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py <span class="m">3</span> -s <span class="m">0</span>
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s <span class="o">{</span><span class="m">1</span>,2<span class="o">}]</span> square
pug.py: error: argument -s/--sleep: invalid choice: <span class="m">0</span> <span class="o">(</span>choose from <span class="m">1</span>, <span class="m">2</span><span class="o">)</span>
$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s <span class="o">{</span><span class="m">1</span>,2<span class="o">}]</span> square

positional arguments:
  square                您说个数，我就能告诉您这个数的平方！

optional arguments:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -s <span class="o">{</span><span class="m">1</span>,2<span class="o">}</span>, --sleep <span class="o">{</span><span class="m">1</span>,2<span class="o">}</span>
                        让我睡会儿，困死了！</code></pre></div>
<p>效果还可以，现在尝试另一种玩法，先看代码：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：{answer}！&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;半睡半醒的我当然听得清你说什么，很简单的题嘛：{answer}!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;我很清醒，结果是：{answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>再看一下结果：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py <span class="m">3</span> -s
半睡半醒的我当然听得清你说什么，很简单的题嘛：9!
$ python3 pug.py <span class="m">3</span> -ss
虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：9！
$ python3 pug.py <span class="m">3</span> -sss
我很清醒，结果是：9!
$ python3 pug.py <span class="m">3</span>
我很清醒，结果是：9!</code></pre></div>
<p>好像第三条有点问题哈，修复一下这个bug：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：{answer}！&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;半睡半醒的我当然听得清你说什么，很简单的题嘛：{answer}!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;我很清醒，结果是：{answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>再看一下这次是不是更好了：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py <span class="m">3</span> -s
半睡半醒的我当然听得清你说什么，很简单的题嘛：9!
$ python3 pug.py <span class="m">3</span> -ss
虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：9！
$ python3 pug.py <span class="m">3</span> -sss
虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：9！
$ python3 pug.py <span class="m">3</span>
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">&#34;pug.py&#34;</span>, line <span class="m">7</span>, in &lt;module&gt;
    <span class="k">if</span> args.sleep &gt;<span class="o">=</span> <span class="m">2</span>:
TypeError: <span class="s1">&#39;&gt;=&#39;</span> not supported between instances of <span class="s1">&#39;NoneType&#39;</span> and <span class="s1">&#39;int&#39;</span></code></pre></div>
<p>哎呀，好像最后一个让小狗子炸锅了，稍微修理一下它（给参数指定默认值）：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;虽然我睡的很死，但我的耳朵好像还挺好使的的，用耳朵都能算的：{answer}！&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;半睡半醒的我当然听得清你说什么，很简单的题嘛：{answer}!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;我很清醒，结果是：{answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>看一下是否正常了：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py <span class="m">3</span>
我很清醒，结果是：9!</code></pre></div>
<p>OKay! 效果不错，小狗子修炼得不错了！</p>

<h2 id="互斥参数">互斥参数</h2>

<p>有的时候小狗子的行为是互斥的，比如睡着觉的时候不能跳舞，跳舞的时候没有在睡觉，所以呀，有的时候还需要互斥参数的使用。</p>

<p>使用起来并不复杂，丰富一下我们的小狗子：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_mutually_exclusive_group</span><span class="p">()</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--dance&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;好开心，让我跳会儿舞！&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>

<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;睡觉的我依然给力，{args.square} 的平方是 {answer}!&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">dance</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;跳舞的时候，我的大脑非常活跃，所以，{args.square} 的平方是 {answer}!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{args.square} 的平方是 {answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>现在小狗子点了新技能，展示一下：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s <span class="p">|</span> -d<span class="o">]</span> square

positional arguments:
  square       您说个数，我就能告诉您这个数的平方！

optional arguments:
  -h, --help   show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -s, --sleep  让我睡会儿，困死了！
  -d, --dance  好开心，让我跳会儿舞！
$ python3 pug.py <span class="m">5</span>
<span class="m">5</span> 的平方是 <span class="m">25</span>!
$ python3 pug.py -s <span class="m">5</span>
睡觉的我依然给力，5 的平方是 <span class="m">25</span>!
$ python3 pug.py -d <span class="m">5</span>
跳舞的时候，我的大脑非常活跃，所以，5 的平方是 <span class="m">25</span>!
$ python3 pug.py -d -s <span class="m">5</span>
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s <span class="p">|</span> -d<span class="o">]</span> square
pug.py: error: argument -s/--sleep: not allowed with argument -d/--dance</code></pre></div>
<p>对了，我们应该让小狗子可以自我介绍，在初始化参数分析器的时候添加描述就好了：</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">argparse</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;我是一只快乐的哈巴狗，我会算整数的平方哦！而且跳着舞或者睡着觉的时候我依然可以呢！&#39;</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_mutually_exclusive_group</span><span class="p">()</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s2">&#34;--sleep&#34;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;让我睡会儿，困死了！&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--dance&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;好开心，让我跳会儿舞！&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&#34;square&#34;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;您说个数，我就能告诉您这个数的平方！&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">square</span> <span class="o">**</span> <span class="mi">2</span>

<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">sleep</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;睡觉的我依然给力，{args.square} 的平方是 {answer}!&#39;</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">args</span><span class="o">.</span><span class="n">dance</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;跳舞的时候，我的大脑非常活跃，所以，{args.square} 的平方是 {answer}!&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{args.square} 的平方是 {answer}!&#39;</span><span class="p">)</span></code></pre></div>
<p>让它好好的自我介绍一下自己吧：</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ python3 pug.py -h
usage: pug.py <span class="o">[</span>-h<span class="o">]</span> <span class="o">[</span>-s <span class="p">|</span> -d<span class="o">]</span> square

我是一只快乐的哈巴狗，我会算整数的平方哦！而且跳着舞或者睡着觉的时候我依然可以呢！

positional arguments:
  square       您说个数，我就能告诉您这个数的平方！

optional arguments:
  -h, --help   show this <span class="nb">help</span> message and <span class="nb">exit</span>
  -s, --sleep  让我睡会儿，困死了！
  -d, --dance  好开心，让我跳会儿舞！</code></pre></div>
<h2 id="总结">总结</h2>

<p>作者希望您通过与小哈巴狗的玩耍，很快学会 <strong>argparse</strong> 库的使用，我们也要像它一样快乐才好！(◐‿◑)</p>

<h2 id="参考">参考</h2>

<ul>
<li><a href="https://docs.python.org/3.7/howto/argparse.html" target="_blank">Argparse Tutorial</a></li>
<li><a href="http://blog.xiayf.cn/2013/03/30/argparse/" target="_blank">argparse - 命令行选项与参数解析（译）</a></li>
</ul>
			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://www.smslit.top/tags/develop">develop</a></span><span class="tag"><a href="https://www.smslit.top/tags/python">python</a></span>
				</p>
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
					5014 字
				</p>
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
					2018-09-13 15:16 &#43;0800</p>
			</footer>
		</article>
		<aside id="toc">
			<div class="toc-title">目录</div>
			<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#初步感受">初步感受</a></li>
<li><a href="#positional-arguments-的使用">Positional arguments 的使用</a></li>
<li><a href="#optional-arguments-的使用">Optional arguments 的使用</a></li>
<li><a href="#positional-arguments-和-optional-arguments-结合使用">Positional arguments 和 Optional arguments 结合使用</a></li>
<li><a href="#互斥参数">互斥参数</a></li>
<li><a href="#总结">总结</a></li>
<li><a href="#参考">参考</a></li>
</ul></li>
</ul>
</nav>
		</aside>
		<div class="post-nav thin">
			<a class="next-post" href="https://www.smslit.top/2018/09/14/image2charspic/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;下一篇</span><br><span>python3实现图片转换为字符画</span>
			</a>
			<a class="prev-post" href="https://www.smslit.top/2018/09/12/convert-ebook/">
				<span class="post-nav-label">上一篇&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>AZW3 格式电子书转换为 MOBI 格式保持原有排版格式</span>
			</a>
		</div>
		<div id="comments" class="thin">
		<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">打赏作者</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/assets/pay/wechatpay.png">
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/assets/pay/alipay.png">
      </label>
  </div>
</div>


<span id="/2018/09/13/python-argparse/" class="leancloud_visitors" data-flag-title="argparse 库的使用">
  <span class="post-meta-item-text">访问量 </span>
  <span class="leancloud-visitors-count"></span>
  <p></p>
</span>
<div id="vcomments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script type="text/javascript">
  new Valine({
      el: '#vcomments' ,
      appId: 'IlJ4XQsE83q10RN3Maoglx2x-gzGzoHsz',
      appKey: 'OxVuAMUYBTbDMO9vO2IqTsMR',
      notify:  false , 
      verify:  false , 
      avatar:'', 
      placeholder: '说点什么吧...(提醒：填写邮箱，若有人回复您，您将及时收到提醒邮件！)',
      visitor:  true 
  });
</script>
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2019 <a href="https://www.smslit.top">5km</a> &#183; <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://www.smslit.top/post/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="https://www.smslit.top/js/main.min.8f39f24808e9d0a9b02da58c2d2838da859dc0b7bdfadbdb1883aae8b6adacfe.js" integrity="sha256-jznySAjp0KmwLaWMLSg42oWdwLe9+tvbGIOq6LatrP4="></script>

	
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: {equationNumbers: {autoNumber: "AMS"}},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>

</html>
